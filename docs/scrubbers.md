<!--
GENERATED FILE - DO NOT EDIT
This file was generated by [MarkdownSnippets](https://github.com/SimonCropp/MarkdownSnippets).
Source File: /docs/mdsource/scrubbers.source.md
To change this file edit the source file and then run MarkdownSnippets.
-->

# Scrubbers

Scrubbers run on the final string prior to doing the verification action.

They can be defined at three levels:

 * Method: Will run the verification in the current test method.
 * Class: Will run for all verifications in all test methods for a test class.
 * Global: Will run for test methods on all tests.

Multiple scrubbers can bee defined at each level.

Scrubber are excited in reveres order. So the most recent added method scrubber through to earliest added global scrubber.

Global scrubbers should be defined only once at appdomain startup. In this example the scrubber is configured using the [Global Setup](https://github.com/SimonCropp/XunitContext#global-setup) of [XunitContext](https://github.com/SimonCropp/XunitContext). It could also be configured using a [Module Initializer](https://github.com/Fody/ModuleInit).


## XUnit

<!-- snippet: ScrubbersSampleXunit -->
<a id='snippet-scrubberssamplexunit'/></a>
```cs
public class ScrubbersSample :
    VerifyBase
{
    VerifySettings classLevelSettings;

    public ScrubbersSample(ITestOutputHelper output) :
        base(output)
    {
        classLevelSettings = new VerifySettings();
        classLevelSettings.AddScrubber(s => s.Replace("Three", "C"));
    }

    [Fact]
    public Task Simple()
    {
        var settings = new VerifySettings(classLevelSettings);
        settings.AddScrubber(s => s.Replace("Two", "B"));
        return Verify("One Two Three", settings);
    }

    [Fact]
    public Task AfterJson()
    {
        var target = new ToBeScrubbed
        {
            RowVersion = "0x00000000000007D3"
        };

        var settings = new VerifySettings(classLevelSettings);
        settings.AddScrubber(s => s.Replace("0x00000000000007D3", "TheRowVersion"));
        return Verify(target, settings);
    }

    [GlobalSetUp]
    public static class GlobalSetup
    {
        public static void Setup()
        {
            Global.AddScrubber(s => s.Replace("One", "A"));
        }
    }
}
```
<sup><a href='/src/Verify.Xunit.Tests/Scrubbers/ScrubbersSample.cs#L7-L50' title='File snippet `scrubberssamplexunit` was extracted from'>snippet source</a> | <a href='#snippet-scrubberssamplexunit' title='Navigate to start of snippet `scrubberssamplexunit`'>anchor</a></sup>
<!-- endsnippet -->


## NUnit

<!-- snippet: ScrubbersSampleNUnit -->
<a id='snippet-scrubberssamplenunit'/></a>
```cs
[TestFixture]
public class ScrubbersSample
{
    VerifySettings classLevelSettings;

    public ScrubbersSample()
    {
        classLevelSettings = new VerifySettings();
        classLevelSettings.AddScrubber(s => s.Replace("Three", "C"));
    }

    [Test]
    public Task Simple()
    {
        var settings = new VerifySettings(classLevelSettings);
        settings.AddScrubber(s => s.Replace("Two", "B"));
        return Verifier.Verify("One Two Three", settings);
    }

    [Test]
    public Task AfterJson()
    {
        var target = new ToBeScrubbed
        {
            RowVersion = "0x00000000000007D3"
        };

        var settings = new VerifySettings(classLevelSettings);
        settings.AddScrubber(s => s.Replace("0x00000000000007D3", "TheRowVersion"));
        return Verifier.Verify(target, settings);
    }

    [OneTimeSetUp]
    public static void Setup()
    {
        Global.AddScrubber(s => s.Replace("One", "A"));
    }
}
```
<sup><a href='/src/Verify.NUnit.Tests/Scrubbers/ScrubbersSample.cs#L6-L45' title='File snippet `scrubberssamplenunit` was extracted from'>snippet source</a> | <a href='#snippet-scrubberssamplenunit' title='Navigate to start of snippet `scrubberssamplenunit`'>anchor</a></sup>
<!-- endsnippet -->


## MSTest

<!-- snippet: ScrubbersSampleMSTest -->
<a id='snippet-scrubberssamplemstest'/></a>
```cs
[TestClass]
public class ScrubbersSample :
    VerifyBase
{
    VerifySettings classLevelSettings;

    public ScrubbersSample()
    {
        classLevelSettings = new VerifySettings();
        classLevelSettings.AddScrubber(s => s.Replace("Three", "C"));
    }

    [TestMethod]
    public Task Simple()
    {
        var settings = new VerifySettings(classLevelSettings);
        settings.AddScrubber(s => s.Replace("Two", "B"));
        return Verify("One Two Three", settings);
    }

    [TestMethod]
    public Task AfterJson()
    {
        var target = new ToBeScrubbed
        {
            RowVersion = "0x00000000000007D3"
        };

        var settings = new VerifySettings(classLevelSettings);
        settings.AddScrubber(s => s.Replace("0x00000000000007D3", "TheRowVersion"));
        return Verify(target, settings);
    }

    [AssemblyInitialize]
    public static void Setup(TestContext testContext)
    {
        Global.AddScrubber(s => s.Replace("One", "A"));
    }
}
```
<sup><a href='/src/Verify.MSTest.Tests/Scrubbers/ScrubbersSample.cs#L6-L46' title='File snippet `scrubberssamplemstest` was extracted from'>snippet source</a> | <a href='#snippet-scrubberssamplemstest' title='Navigate to start of snippet `scrubberssamplemstest`'>anchor</a></sup>
<!-- endsnippet -->


## Results

<!-- snippet: Verify.Xunit.Tests/Scrubbers/ScrubbersSample.Simple.verified.txt -->
<a id='snippet-Verify.Xunit.Tests/Scrubbers/ScrubbersSample.Simple.verified.txt'/></a>
```txt
A B C
```
<sup><a href='/src/Verify.Xunit.Tests/Scrubbers/ScrubbersSample.Simple.verified.txt#L1-L1' title='File snippet `Verify.Xunit.Tests/Scrubbers/ScrubbersSample.Simple.verified.txt` was extracted from'>snippet source</a> | <a href='#snippet-Verify.Xunit.Tests/Scrubbers/ScrubbersSample.Simple.verified.txt' title='Navigate to start of snippet `Verify.Xunit.Tests/Scrubbers/ScrubbersSample.Simple.verified.txt`'>anchor</a></sup>
<!-- endsnippet -->

<!-- snippet: Verify.Xunit.Tests/Scrubbers/ScrubbersSample.AfterJson.verified.txt -->
<a id='snippet-Verify.Xunit.Tests/Scrubbers/ScrubbersSample.AfterJson.verified.txt'/></a>
```txt
{
  RowVersion: 'TheRowVersion'
}
```
<sup><a href='/src/Verify.Xunit.Tests/Scrubbers/ScrubbersSample.AfterJson.verified.txt#L1-L3' title='File snippet `Verify.Xunit.Tests/Scrubbers/ScrubbersSample.AfterJson.verified.txt` was extracted from'>snippet source</a> | <a href='#snippet-Verify.Xunit.Tests/Scrubbers/ScrubbersSample.AfterJson.verified.txt' title='Navigate to start of snippet `Verify.Xunit.Tests/Scrubbers/ScrubbersSample.AfterJson.verified.txt`'>anchor</a></sup>
<!-- endsnippet -->

