name: on-tag-do-release
on: 
  push:
    tags:
      - '[0-9]+\.[0-9]+\.[0-9]+'
jobs:
  release:
    runs-on: windows-latest
    steps:
    - name: Get env vars
      run: |
        echo GITHUB_WORKFLOW   = ${env::GITHUB_WORKFLOW}
        echo GITHUB_WORKFLOW   = ${env:GITHUB_WORKFLOW}
        echo GITHUB_WORKFLOW   = $env::GITHUB_WORKFLOW
        echo GITHUB_WORKFLOW   = $env:GITHUB_WORKFLOW
        echo HOME              = $HOME
        echo GITHUB_ACTION     = $GITHUB_ACTION
        echo GITHUB_ACTIONS    = $GITHUB_ACTIONS
        echo GITHUB_REPOSITORY = $GITHUB_REPOSITORY
        echo GITHUB_EVENT_NAME = $GITHUB_EVENT_NAME
        echo GITHUB_EVENT_PATH = $GITHUB_EVENT_PATH
        echo GITHUB_WORKSPACE  = $GITHUB_WORKSPACE
        echo GITHUB_SHA        = $GITHUB_SHA
        echo GITHUB_REF        = $GITHUB_REF
        echo tag        = ${GITHUB_REF:10}
        echo repo        = ${GITHUB_REPOSITORY:11}
        echo owner        = ${GITHUB_REPOSITORY:~0,10} 
      shell: bash
#    - uses: actions/setup-dotnet@v1
#      with:
#        dotnet-version: '3.1.100'
    - name: Run
      run: | 
        dotnet tool install --global GitReleaseManager.Tool
        dotnet-gitreleasemanager create -m ${GITHUB_REF:10} --token ${{secrets.GITHUB_TOKEN}} -o ${GITHUB_REPOSITORY:~0,10} -r ${GITHUB_REPOSITORY:11}
      shell: bash
