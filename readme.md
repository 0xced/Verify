<!--
GENERATED FILE - DO NOT EDIT
This file was generated by [MarkdownSnippets](https://github.com/SimonCropp/MarkdownSnippets).
Source File: /readme.source.md
To change this file edit the source file and then run MarkdownSnippets.
-->

# <img src="/src/icon.png" height="30px"> Verify

[![Build status](https://ci.appveyor.com/api/projects/status/dpqylic0be7s9vnm/branch/master?svg=true)](https://ci.appveyor.com/project/SimonCropp/Verify)
[![NuGet Status](https://img.shields.io/nuget/v/Verify.Xunit.svg?cacheSeconds=86400)](https://www.nuget.org/packages/Verify.Xunit/)

Verification tool to enable simple approval of complex models using [Json.net](https://www.newtonsoft.com/json).

<!-- toc -->
## Contents

  * [NuGet package](#nuget-package)
  * [Usage](#usage)
  * [Not valid json](#not-valid-json)
  * [Validating multiple instances](#validating-multiple-instances)
  * [Documentation](#documentation)
<!-- endtoc -->


## NuGet package

https://nuget.org/packages/Verify.Xunit/


## Usage

Given a class to be tested:

<!-- snippet: ClassBeingTested -->
<a id='snippet-classbeingtested'/></a>
```cs
public static class ClassBeingTested
{
    public static Person FindPerson()
    {
        return new Person
        {
            Id = new Guid("ebced679-45d3-4653-8791-3d969c4a986c"),
            Title = Title.Mr,
            GivenNames = "John",
            FamilyName = "Smith",
            Spouse = "Jill",
            Children = new List<string> {"Sam", "Mary"},
            Address = new Address
            {
                Street = "1 Puddle Lane",
                Country = "USA"
            }
        };
    }
}
```
<sup>[snippet source](/src/Verify.Xunit.Tests/Snippets/ClassBeingTested.cs#L4-L25) / [anchor](#snippet-classbeingtested)</sup>
<!-- endsnippet -->

It can be tested as follows:

<!-- snippet: SampleTest -->
<a id='snippet-sampletest'/></a>
```cs
public class SampleTest :
    VerifyBase
{
    [Fact]
    public Task Simple()
    {
        var person = ClassBeingTested.FindPerson();
        return Verify(person);
    }

    public SampleTest(ITestOutputHelper output) :
        base(output)
    {
    }
}
```
<sup>[snippet source](/src/Verify.Xunit.Tests/Snippets/SampleTest.cs#L6-L22) / [anchor](#snippet-sampletest)</sup>
<!-- endsnippet -->

When run the test will fail with:


Assuming this was verified:

<!-- snippet: before -->
<a id='snippet-before'/></a>
```cs
var person = new Person
{
    GivenNames = "John",
    FamilyName = "Smith",
    Spouse = "Jill",
    Address = new Address
    {
        Street = "1 Puddle Lane",
        Country = "USA"
    }
};

await Verify(person);
```
<sup>[snippet source](/src/Verify.Xunit.Tests/VerifyObjectSamples.cs#L48-L64) / [anchor](#snippet-before)</sup>
<!-- endsnippet -->

Then attempt to verify this:

<!-- snippet: after -->
<a id='snippet-after'/></a>
```cs
var person = new Person
{
    GivenNames = "John",
    FamilyName = "Smith",
    Spouse = "Jill",
    Address = new Address
    {
        Street = "1 Puddle Lane",
        Suburb = "Gotham",
        Country = "USA"
    }
};

await Verify(person);
```
<sup>[snippet source](/src/Verify.Xunit.Tests/VerifyObjectSamples.cs#L108-L125) / [anchor](#snippet-after)</sup>
<!-- endsnippet -->

The serialized json version of these will then be compared and you will be displayed the differences in the diff tool you have asked ApprovalTests to use. For example:

![SampleDiff](/src/SampleDiff.png)


## Not valid json

Note that the output is technically not valid json. [Single quotes are used](docs/serializer-settings.md#single-quotes-used) and [names are not quoted](docs/serializer-settings.md#quotename-is-false). The reason for this is to make the resulting output easier to read and understand.


## Validating multiple instances

When validating multiple instances, an [anonymous type](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/anonymous-types) can be used for verification

<!-- snippet: anon -->
<a id='snippet-anon'/></a>
```cs
var person1 = new Person
{
    GivenNames = "John",
    FamilyName = "Smith"
};
var person2 = new Person
{
    GivenNames = "Marianne",
    FamilyName = "Aguirre"
};

await Verify(
    new
    {
        person1,
        person2
    });
```
<sup>[snippet source](/src/Verify.Xunit.Tests/VerifyObjectSamples.cs#L70-L90) / [anchor](#snippet-anon)</sup>
<!-- endsnippet -->

Results in the following:

<!-- snippet: VerifyObjectSamples.Anon.verified.txt -->
<a id='snippet-VerifyObjectSamples.Anon.verified.txt'/></a>
```txt
{
  person1: {
    GivenNames: 'John',
    FamilyName: 'Smith'
  },
  person2: {
    GivenNames: 'Marianne',
    FamilyName: 'Aguirre'
  }
}
```
<sup>[snippet source](/src/Verify.Xunit.Tests/VerifyObjectSamples.Anon.verified.txt#L1-L10) / [anchor](#snippet-VerifyObjectSamples.Anon.verified.txt)</sup>
<!-- endsnippet -->


## Documentation

 * [Serializer Settings](docs/serializer-settings.md)
 * [File Extension](docs/file-extension.md)
 * [Named Tuples](docs/named-tuples.md)
 * [Scrubbers](docs/scrubbers.md)
 * [Diff Tool](docs/diff-tool.md)


## Release Notes

See [closed milestones](../../milestones?state=closed).


## Icon

[Helmet](https://thenounproject.com/term/helmet/9554/) designed by [Leonidas Ikonomou](https://thenounproject.com/alterego) from [The Noun Project](https://thenounproject.com).
